"use strict";var M=Object.create;var f=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var S=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty;var T=(t,i)=>{for(var r in i)f(t,r,{get:i[r],enumerable:!0})},y=(t,i,r,n)=>{if(i&&typeof i=="object"||typeof i=="function")for(let a of C(i))!I.call(t,a)&&a!==r&&f(t,a,{get:()=>i[a],enumerable:!(n=F(i,a))||n.enumerable});return t};var m=(t,i,r)=>(r=t!=null?M(S(t)):{},y(i||!t||!t.__esModule?f(r,"default",{value:t,enumerable:!0}):r,t)),R=t=>y(f({},"__esModule",{value:!0}),t);var $={};T($,{activate:()=>W,deactivate:()=>_});module.exports=R($);var o=m(require("vscode")),D=m(require("path"));var x=m(require("fs/promises")),P=require("readline"),k=require("fs"),u=m(require("path"));async function j(t){let i=(0,P.createInterface)({input:(0,k.createReadStream)(t,{end:9999})}),r="",n=!1;for await(let s of i){if(n){s.includes("*/")&&(n=!1);continue}let c=s.indexOf("/*");if(c!==-1){n=!0;let e=s.indexOf("*/");if(e!==-1&&e>c){n=!1;let d=s.slice(0,c)+s.slice(e+2);if(d.trim()){r=d.trim();break}continue}continue}let l=s.split("//")[0].trim();if(l){r=l;break}}return i.close(),['"use client"',"'use client'","`use client`"].some(s=>r.includes(s))}async function v(t){let i=1,r=/\.(js|jsx|css|ts|tsx|sass|scss)$/,n=[{id:0,folderName:u.basename(t),parentNode:null,path:t,contents:[],render:"server"}];async function a(s,c){let l=await x.readdir(s,{withFileTypes:!0});for(let e of l){let d=u.join(s,e.name);if(e.isDirectory()){let b={id:i++,folderName:e.name,parentNode:c,path:d,contents:[],render:"server"};n.push(b),await a(d,b.id)}else r.test(e.name)&&(n[c].contents.push(e.name),await j(d)&&(n[c].render="client"))}}try{return await a(t,0),n}catch{return{}}}var w=require("fs");var E=m(require("fs/promises")),h=m(require("path")),g=m(require("vscode"));async function N(t){try{if(!g.workspace.workspaceFolders)return"";let i=g.workspace.workspaceFolders[0].uri.fsPath,r=h.isAbsolute(t)?t:h.join(i,t);return!r.startsWith(i)||!(await E.stat(r)).isDirectory()?"":r}catch{return""}}var p=null;async function O(t,i){try{let r=await v(i),n=JSON.stringify(r);t.webview.postMessage({command:"sendString",data:n})}catch(r){o.window.showErrorMessage("Error sending updated directory: "+r.message)}}function W(t){console.log("activate has been invoked");let i="next-nav-icon";t.globalState.update(i,!0);let r=o.window.createStatusBarItem(o.StatusBarAlignment.Right);r.text="Next.Nav",r.command="next-extension.next-nav",r.tooltip="Launch Next Nav",r.show(),t.subscriptions.push(r);let n=o.commands.registerCommand("next-extension.next-nav",async()=>{let a=o.window.createWebviewPanel("Next.Nav","Next.Nav",o.ViewColumn.One,{enableScripts:!0,retainContextWhenHidden:!0});a.webview.onDidReceiveMessage(async s=>{switch(console.log("Received message:",s),s.command){case"submitDir":let c=await N(s.folderName);c?(p=c,o.window.showInformationMessage("Directory is now "+p),a.webview.postMessage({command:"submitDirResponse",result:!0})):(s.showError&&o.window.showErrorMessage("Invalid directory: "+s.folderName),a.webview.postMessage({command:"submitDirResponse",result:!1}));break;case"getRequest":p?await O(a,p):(console.error("No directory has been submitted yet."),o.window.showErrorMessage("No directory has been submitted yet."));break;case"open_file":let l=s.filePath;try{let e=await o.workspace.openTextDocument(l);await o.window.showTextDocument(e),console.log(`Switched to tab with file: ${l}`)}catch(e){o.window.showErrorMessage(`Error opening file: ${e.message}`),console.error(`Error opening file: ${e}`)}break;case"addFile":try{let e=s.filePath;await w.promises.writeFile(e,""),a.webview.postMessage({command:"added_addFile"})}catch(e){console.error("Error creating file:",e.message),o.window.showErrorMessage("Error creating file: "+e.message)}break;case"addFolder":try{let e=s.filePath;await w.promises.mkdir(e),a.webview.postMessage({command:"added_addFolder"})}catch(e){console.error("Error creating folder:",e.message),o.window.showErrorMessage("Error creating folder: "+e.message)}break;case"deleteFile":try{let e=s.filePath,d=o.Uri.file(e);if(await w.promises.stat(e))await o.workspace.fs.delete(d,{useTrash:!0});else throw new Error("File does not exist");a.webview.postMessage({command:"added_deleteFile"})}catch(e){console.error("Error deleting file:",e.message),o.window.showErrorMessage("Error deleting file: "+e.message)}break;case"deleteFolder":try{let e=s.filePath,d=o.Uri.file(e);if(await w.promises.stat(e))await o.workspace.fs.delete(d,{recursive:!0,useTrash:!0});else throw new Error("Folder does not exist");a.webview.postMessage({command:"added_deleteFolder"})}catch(e){o.window.showErrorMessage("Error deleting folder: "+e.message)}break}},void 0,t.subscriptions);try{let s=D.join(t.extensionPath,"webview-react-app","dist","bundle.js"),c=await w.promises.readFile(s,"utf-8");a.webview.html=`
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Next.Nav</title>
        </head>
        <body>
          <div id="root"></div>
          <script>
          ${c}
          </script>
        </body>
        </html>`}catch{}o.window.showInformationMessage("Welcome to Next.Nav!")});t.subscriptions.push(n)}function _(){}0&&(module.exports={activate,deactivate});
